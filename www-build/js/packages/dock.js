/**
 * https://github.com/TAIAUT/Ideafy
 * Proprietary License - All rights reserved
 * Authors: Vincent Weyl <vincent.weyl@taiaut.com> - Olivier Wietrich <Olivier.Wietrich@taiaut.com
 * Copyright (c) 2012-2013 TAIAUT
 */

define(["Olives/OObject","Amy/Stack-plugin","Amy/Control-plugin","public/public","library/library","brainstorm/brainstorm","connect/connect","dashboard/dashboard","service/map","service/config","./notify","service/newidea","service/help","service/new2q","service/new2c","service/tips"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){return function(){var d=new e,m,g,y,b=new n(this),w=f.get("observer"),E=f.get("user"),S=new t;return d.plugins.addAll({dockstack:S,dockcontrol:b}),d.alive(a.get("dock")),d.init=function(t){var n=new l;S.getStack().add("#public",new r),S.getStack().add("#library",new i),S.getStack().add("#brainstorm",new s),S.getStack().add("#connect",new o),S.getStack().add("#dashboard",new u),n.init(),m=new c,g=new p,E.get("settings").startupScreen?S.getStack().show(E.get("settings").startupScreen):S.getStack().show("#public");if(t||E.get("settings").showTips!==!1)y=new v,y.init(t)},d.reset=function(){S=new t,d.init()},this.setCurrentWidget=function(e){var t=e.target.getAttribute("href"),n=3e3;t!==S.getStack().getCurrentName()?(S.getStack().getCurrentScreen().hideMenu(),S.getStack().show(t),S.getStack().getCurrentScreen().showMenu(),setTimeout(function(){S.getStack().getCurrentScreen().hideMenu()},n)):S.getStack().getCurrentScreen().showMenu()},w.watch("replay-session",function(e,t){S.getStack().show("#brainstorm"),document.querySelector(".dock-item.selected").classList.remove("selected"),document.querySelector(".dock-item[href='#brainstorm']").classList.add("selected")}),w.watch("display-doc",function(){S.getStack().show("#library"),document.querySelector(".dock-item.selected").classList.remove("selected"),document.querySelector(".dock-item[href='#library']").classList.add("selected")}),w.watch("display-message",function(e){S.getStack().show("#connect"),document.querySelector(".dock-item.selected").classList.remove("selected"),document.querySelector(".dock-item[href='#connect']").classList.add("selected")}),w.watch("display-tutorials",function(e){S.getStack().show("#dashboard"),document.querySelector(".dock-item.selected").classList.remove("selected"),document.querySelector(".dock-item[href='#dashboard']").classList.add("selected")}),d}});