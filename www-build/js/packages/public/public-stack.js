/**
 * https://github.com/TAIAUT/Ideafy
 * Proprietary License - All rights reserved
 * Author: Vincent Weyl <vincent.weyl@taiaut.com>
 * Copyright (c) 2012-2013 TAIAUT
 */

define(["Olives/OObject","service/map","Amy/Stack-plugin","./detail-stack/public-idea","./detail-stack/public-edit","./detail-stack/public-sendmail","./detail-stack/public-share","service/config","Store"],function(e,t,n,r,i,s,o,u,a){return function(){var l=new e,c=new n,h=t.get("public-detail"),p=u.get("observer"),d=new a,v=0;return l.plugins.addAll({detailstack:c}),l.alive(h),l.reset=function(t,n){d=t,v=n,c.getStack().get("#public-ideadetail").reset(t,n),c.getStack().show("#public-ideadetail")},l.action=function(t){switch(t){case"#public-edit":c.getStack().get("#public-edit").reset(d.get(v).id),c.getStack().show("#public-edit");break;case"#public-favorites":break;case"#public-share":c.getStack().get("#public-share").reset(d.get(v).doc),c.getStack().show("#public-share");break;case"close":c.getStack().show("#public-ideadetail");break;default:c.getStack().show("#public-ideadetail")}},l.edit=function(t){c.getStack().get("#public-edit").reset(t),c.getStack().show("#public-edit")},l.sendMail=function(t){c.getStack().get("#public-sendmail").reset(t),c.getStack().show("#public-sendmail")},l.share=function(t){c.getStack().get("#public-share").reset(t),c.getStack().show("#public-share")},c.getStack().add("#public-ideadetail",new r(l.action)),c.getStack().add("#public-edit",new i(l.action)),c.getStack().add("#public-sendmail",new s(l.action)),c.getStack().add("#public-share",new o(l.action)),p.watch("public-viewidea",function(e){l.viewIdea(e)}),p.watch("public-edit",function(e){l.edit(e)}),p.watch("public-sendmail",function(e){l.sendMail(e)}),p.watch("public-share",function(e){l.share(e)}),PDS=c,l}});