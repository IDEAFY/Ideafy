/*
 Olives 1.1.9 http://flams.github.com/olives
 The MIT License (MIT)
 Copyright (c) 2012 Olivier Scherrer <pode.fr@gmail.com> - Olivier Wietrich <olivier.wietrich@gmail.com>
*/

define("Olives/DomUtils",function(){return{getNodes:function(e,t){return this.isAcceptedType(e)?(e.parentNode||document.createDocumentFragment().appendChild(e),e.parentNode.querySelectorAll(t||"*")):!1},getDataset:function(e){var t=0,n,r={},i,s;if(this.isAcceptedType(e)){if(e.hasOwnProperty("dataset"))return e.dataset;for(n=e.attributes.length;t<n;t++)i=e.attributes[t].name.split("-"),i.shift()=="data"&&(r[s=i.join("-")]=e.getAttribute("data-"+s));return r}return!1},isAcceptedType:function(e){return e instanceof HTMLElement||e instanceof SVGElement?!0:!1},setAttribute:function(e,t,n){return e instanceof HTMLElement?(e[t]=n,!0):e instanceof SVGElement?(e.setAttribute(t,n),!0):!1}}}),define("Olives/Event-plugin",function(){return function(e){this.listen=function(t,n,r,i){t.addEventListener(n,function(n){e[r].call(e,n,t)},i=="true")}}}),define("Olives/LocalStore",["Store","Tools"],function(e,t){function n(){var e=null,n=localStorage,r=function(){n.setItem(e,this.toJSON())};this.setLocalStorage=function(e){return e&&e.setItem instanceof Function?(n=e,!0):!1},this.getLocalStorage=function(){return n},this.sync=function(i){return typeof i=="string"?(e=i,i=JSON.parse(n.getItem(i)),t.loop(i,function(e,t){this.has(t)||this.set(t,e)},this),r.call(this),this.watch("added",r,this),this.watch("updated",r,this),this.watch("deleted",r,this),!0):!1}}return function(t){return n.prototype=new e(t),new n}}),define("Olives/Model-plugin",["Store","Observable","Tools","Olives/DomUtils"],function(e,t,n,r){return function(t,i){var s=null,o={},u={};this.observers={},this.setModel=function(t){return t instanceof e?(s=t,!0):!1},this.getModel=function(){return s},this.ItemRenderer=function(t,i){var o=null,u=null,a=null,l=null,h=null;this.setRenderer=function(e){return o=e,!0},this.getRenderer=function(){return o},this.setRootNode=function(e){return r.isAcceptedType(e)?(a=e,e=a.querySelector("*"),this.setRenderer(e),e&&a.removeChild(e),!0):!1},this.getRootNode=function(){return a},this.setPlugins=function(e){return u=e,!0},this.getPlugins=function(){return u},this.items=new e([]),this.setStart=function(e){return l=parseInt(e,10)},this.getStart=function(){return l},this.setNb=function(e){return h=e=="*"?e:parseInt(e,10)},this.getNb=function(){return h},this.addItem=function(e){var t;return typeof e=="number"&&!this.items.get(e)?(t=this.create(e))?((e=this.getNextItem(e))?a.insertBefore(t,e):a.appendChild(t),!0):!1:!1},this.getNextItem=function(e){return this.items.alter("slice",e+1).filter(function(e){if(r.isAcceptedType(e))return!0})[0]},this.removeItem=function(e){var t=this.items.get(e);return t?(a.removeChild(t),this.items.set(e),!0):!1},this.create=function(e){if(s.has(e)){var t=o.cloneNode(!0),i=r.getNodes(t);return n.toArray(i).forEach(function(t){t.setAttribute("data-"+u.name+"_id",e)}),this.items.set(e,t),u.apply(t),t}},this.render=function(){var e=h=="*"?s.getNbItems():h,t=[];if(h!==null&&l!==null){this.items.loop(function(n,r){(r<l||r>=l+e||!s.has(r))&&t.push(r)},this),t.sort(n.compareNumbers).reverse().forEach(this.removeItem,this);for(var r=l,i=e+l;r<i;r++)this.addItem(r);return!0}return!1},this.setPlugins(t),this.setRootNode(i)},this.setItemRenderer=function(e,t){u[e||"default"]=t},this.getItemRenderer=function(e){return u[e]},this.foreach=function(e,t,n,r){var i=new this.ItemRenderer(this.plugins,e);i.setStart(n||0),i.setNb(r||"*"),i.render(),s.watch("added",i.render,i),s.watch("deleted",function(e){i.render(),this.observers[e]&&this.observers[e].forEach(function(e){s.unwatchValue(e)},this),delete this.observers[e]},this),this.setItemRenderer(t,i)},this.updateStart=function(e,t){var n=this.getItemRenderer(e);return n?(n.setStart(t),!0):!1},this.updateNb=function(e,t){var n=this.getItemRenderer(e);return n?(n.setNb(t),!0):!1},this.refresh=function(e){return(e=this.getItemRenderer(e))?(e.render(),!0):!1},this.bind=function(e,t,i){var i=i||"",o=e.getAttribute("data-"+this.plugins.name+"_id"),u=i.split("."),a=o||u.shift(),l=o?i:u.join("."),o=n.getNestedProperty(s.get(a),l),c=n.toArray(arguments).slice(3);if(o||o===0||o===!1)this.execBinding.apply(this,[e,t,o].concat(c))||r.setAttribute(e,t,o);this.hasBinding(t)||e.addEventListener("change",function(){s.has(a)&&(l?s.update(a,i,e[t]):s.set(a,e[t]))},!0),this.observers[a]=this.observers[a]||[],this.observers[a].push(s.watchValue(a,function(i){this.execBinding.apply(this,[e,t,n.getNestedProperty(i,l)].concat(c))||r.setAttribute(e,t,n.getNestedProperty(i,l))},this))},this.set=function(e){return r.isAcceptedType(e)&&e.name?(s.set(e.name,e.value),!0):!1},this.form=function a(a){if(a&&a.nodeName=="FORM"){var e=this;return a.addEventListener("submit",function(t){n.toArray(a.querySelectorAll("[name]")).forEach(e.set,e),t.preventDefault()},!0),!0}return!1},this.addBinding=function(e,t){return e&&typeof e=="string"&&typeof t=="function"?(o[e]=t,!0):!1},this.execBinding=function(e,t){return this.hasBinding(t)?(o[t].apply(e,Array.prototype.slice.call(arguments,2)),!0):!1},this.hasBinding=function(e){return o.hasOwnProperty(e)},this.getBinding=function(e){return o[e]},this.addBindings=function(e){return n.loop(e,function(e,t){this.addBinding(t,e)},this)},this.setModel(t),this.addBindings(i)}}),define("Olives/OObject",["StateMachine","Store","Olives/Plugins","Olives/DomUtils","Tools"],function(e,t,n,r,i){return function(s){var o=function(e){var t=a||document.createElement("div");if(!e.template)throw Error("UI.template must be set prior to render");typeof e.template=="string"?t.innerHTML=e.template.trim():r.isAcceptedType(e.template)&&t.appendChild(e.template);if(t.childNodes.length>1)throw Error("UI.template should have only one parent node");e.dom=t.childNodes[0],e.plugins.apply(e.dom)},u=function h(e,h,t){h&&(t?h.insertBefore(e.dom,t):h.appendChild(e.dom),a=h)},a=null,l=new e("Init",{Init:[["render",o,this,"Rendered"],["place",function(e,t){o(e),u.apply(null,i.toArray(arguments))},this,"Rendered"]],Rendered:[["place",u,this],["render",o,this]]});this.model=s instanceof t?s:new t,this.plugins=new n,this.dom=this.template=null,this.place=function(e,t){l.event("place",this,e,t)},this.render=function(){l.event("render",this)},this.setTemplateFromDom=function(e){return r.isAcceptedType(e)?(this.template=e,!0):!1},this.alive=function(e){return r.isAcceptedType(e)?(this.setTemplateFromDom(e),this.place(e.parentNode,e.nextElementSibling),!0):!1},this.getCurrentPlace=function(){return a}}}),define("Olives/Plugins",["Tools","Olives/DomUtils"],function(e,t){return function(){var n={},r=function(e){return e.trim()},i=function(e,t,i){t.split(";").forEach(function(t){var s=t.split(":"),t=s[0].trim(),s=s[1]?s[1].split(",").map(r):[];s.unshift(e),n[i]&&n[i][t]&&n[i][t].apply(n[i],s)})};this.add=function(e,t){var r=this;return typeof e=="string"&&typeof t=="object"&&t?(n[e]=t,t.plugins={name:e,apply:function(){return r.apply.apply(r,arguments)}},!0):!1},this.addAll=function(t){return e.loop(t,function(e,t){this.add(t,e)},this)},this.get=function(e){return n[e]},this.del=function(e){return delete n[e]},this.apply=function(n){var r;return t.isAcceptedType(n)?(r=t.getNodes(n),e.loop(e.toArray(r),function(n){e.loop(t.getDataset(n),function(e,t){i(n,e,t)})}),n):!1}}}),define("Olives/Transport",["Observable","Tools"],function(e){return function(t,n){var r=null,i=null;new e,this.setIO=function(e){return e&&typeof e.connect=="function"?(i=e,!0):!1},this.getIO=function(){return i},this.connect=function(e){return typeof e=="string"?(r=i.connect(e),!0):!1},this.getSocket=function(){return r},this.on=function(e,t){return r.on(e,t)},this.once=function(e,t){return r.once(e,t)},this.emit=function(e,t,n){return r.emit(e,t,n)},this.removeListener=function(e,t,n){return r.removeListener(e,t,n)},this.request=function(e,t,n,r){return typeof e=="string"&&typeof t!="undefined"?(t={eventId:Date.now()+Math.floor(Math.random()*1e6),data:t},this.once(t.eventId,function(){n&&n.apply(r||null,arguments)}),this.emit(e,t),!0):!1},this.listen=function(e,t,n,r){if(typeof e=="string"&&typeof t!="undefined"&&typeof n=="function"){var i={eventId:Date.now()+Math.floor(Math.random()*1e6),data:t,keepAlive:!0},s=function(){n&&n.apply(r||null,arguments)},o=this;return this.on(i.eventId,s),this.emit(e,i),function(){o.emit("disconnect-"+i.eventId),o.removeListener(i.eventId,s)}}return!1},this.setIO(t),this.connect(n)}}),define("Olives/UI-plugin",["Olives/OObject","Tools"],function(e,t){return function(n){var r={};this.place=function(t,n){if(!(r[n]instanceof e))throw Error(n+" is not an OObject UI in place:"+n);r[n].place(t)},this.set=function(t,n){return typeof t=="string"&&n instanceof e?(r[t]=n,!0):!1},this.setAll=function(e){t.loop(e,function(e,t){this.set(t,e)},this)},this.get=function(e){return r[e]},this.setAll(n)}}),define("Olives/DomUtils",function(){return{getNodes:function(t,n){return this.isAcceptedType(t)?(t.parentNode||document.createDocumentFragment().appendChild(t),t.parentNode.querySelectorAll(n||"*")):!1},getDataset:function(t){var n=0,r,i={},s,o;if(this.isAcceptedType(t)){if(t.hasOwnProperty("dataset"))return t.dataset;for(r=t.attributes.length;n<r;n++)s=t.attributes[n].name.split("-"),s.shift()=="data"&&(i[o=s.join("-")]=t.getAttribute("data-"+o));return i}return!1},isAcceptedType:function(t){return t instanceof HTMLElement||t instanceof SVGElement?!0:!1},setAttribute:function(t,n,r){return t instanceof HTMLElement?(t[n]=r,!0):t instanceof SVGElement?(t.setAttribute(n,r),!0):!1}}}),define("Olives/Event-plugin",function(){return function(t){this.listen=function(e,n,r,i){e.addEventListener(n,function(n){t[r].call(t,n,e)},i=="true")}}}),define("Olives/LocalStore",["Store","Tools"],function(t,n){function r(){var e=null,t=localStorage,r=function(){t.setItem(e,this.toJSON())};this.setLocalStorage=function(n){return n&&n.setItem instanceof Function?(t=n,!0):!1},this.getLocalStorage=function(){return t},this.sync=function(s){var o;return typeof s=="string"?(e=s,o=JSON.parse(t.getItem(s)),n.loop(o,function(e,t){this.has(t)||this.set(t,e)},this),r.call(this),this.watch("added",r,this),this.watch("updated",r,this),this.watch("deleted",r,this),!0):!1}}return function(n){return r.prototype=new t(n),new r}}),define("Olives/Model-plugin",["Store","Observable","Tools","Olives/DomUtils"],function(t,n,r,s){return function(n,o){var u=null,f={},c={};this.observers={},this.setModel=function(n){return n instanceof t?(u=n,!0):!1},this.getModel=function(){return u},this.ItemRenderer=function(n,o){var f=null,c=null,h=null,p=null,m=null;this.setRenderer=function(t){return f=t,!0},this.getRenderer=function(){return f},this.setRootNode=function(t){var n;return s.isAcceptedType(t)?(h=t,n=h.querySelector("*"),this.setRenderer(n),n&&h.removeChild(n),!0):!1},this.getRootNode=function(){return h},this.setPlugins=function(t){return c=t,!0},this.getPlugins=function(){return c},this.items=new t([]),this.setStart=function(t){return p=parseInt(t,10),p},this.getStart=function(){return p},this.setNb=function(t){return m=t=="*"?t:parseInt(t,10),m},this.getNb=function(){return m},this.addItem=function(t){var n,r;return typeof t=="number"&&!this.items.get(t)?(n=this.create(t),n?(r=this.getNextItem(t),r?h.insertBefore(n,r):h.appendChild(n),!0):!1):!1},this.getNextItem=function(t){return this.items.alter("slice",t+1).filter(function(e){if(s.isAcceptedType(e))return!0})[0]},this.removeItem=function(t){var n=this.items.get(t);return n?(h.removeChild(n),this.items.set(t),!0):!1},this.create=function(t){if(u.has(t)){var n=f.cloneNode(!0),i=s.getNodes(n);return r.toArray(i).forEach(function(e){e.setAttribute("data-"+c.name+"_id",t)}),this.items.set(t,n),c.apply(n),n}},this.render=function(){var t=m=="*"?u.getNbItems():m,n=[];if(m!==null&&p!==null){this.items.loop(function(e,r){(r<p||r>=p+t||!u.has(r))&&n.push(r)},this),n.sort(r.compareNumbers).reverse().forEach(this.removeItem,this);for(i=p,l=t+p;i<l;i++)this.addItem(i);return!0}return!1},this.setPlugins(n),this.setRootNode(o)},this.setItemRenderer=function(t,n){t=t||"default",c[t]=n},this.getItemRenderer=function(t){return c[t]},this.foreach=function(t,n,r,i){var s=new this.ItemRenderer(this.plugins,t);s.setStart(r||0),s.setNb(i||"*"),s.render(),u.watch("added",s.render,s),u.watch("deleted",function(e){s.render(),this.observers[e]&&this.observers[e].forEach(function(e){u.unwatchValue(e)},this),delete this.observers[e]},this),this.setItemRenderer(n,s)},this.updateStart=function(t,n){var r=this.getItemRenderer(t);return r?(r.setStart(n),!0):!1},this.updateNb=function(t,n){var r=this.getItemRenderer(t);return r?(r.setNb(n),!0):!1},this.refresh=function(t){var n=this.getItemRenderer(t);return n?(n.render(),!0):!1},this.bind=function(t,n,i){i=i||"";var o=t.getAttribute("data-"+this.plugins.name+"_id"),f=i.split("."),l=o||f.shift(),c=o?i:f.join("."),h=r.getNestedProperty(u.get(l),c),p=r.toArray(arguments).slice(3);if(h||h===0||h===!1)this.execBinding.apply(this,[t,n,h].concat(p))||s.setAttribute(t,n,h);this.hasBinding(n)||t.addEventListener("change",function(e){u.has(l)&&(c?u.update(l,i,t[n]):u.set(l,t[n]))},!0),this.observers[l]=this.observers[l]||[],this.observers[l].push(u.watchValue(l,function(e){this.execBinding.apply(this,[t,n,r.getNestedProperty(e,c)].concat(p))||s.setAttribute(t,n,r.getNestedProperty(e,c))},this))},this.set=function(t){return s.isAcceptedType(t)&&t.name?(u.set(t.name,t.value),!0):!1},this.form=function(t){if(t&&t.nodeName=="FORM"){var n=this;return t.addEventListener("submit",function(e){r.toArray(t.querySelectorAll("[name]")).forEach(n.set,n),e.preventDefault()},!0),!0}return!1},this.addBinding=function(t,n){return t&&typeof t=="string"&&typeof n=="function"?(f[t]=n,!0):!1},this.execBinding=function(t,n){return this.hasBinding(n)?(f[n].apply(t,Array.prototype.slice.call(arguments,2)),!0):!1},this.hasBinding=function(t){return f.hasOwnProperty(t)},this.getBinding=function(t){return f[t]},this.addBindings=function(t){return r.loop(t,function(e,t){this.addBinding(t,e)},this)},this.setModel(n),this.addBindings(o)}}),define("Olives/OObject",["StateMachine","Store","Olives/Plugins","Olives/DomUtils","Tools"],function(t,n,r,i,s){return function(o){var u=function(t){var n=p||document.createElement("div");if(!t.template)throw Error("UI.template must be set prior to render");typeof t.template=="string"?n.innerHTML=t.template.trim():i.isAcceptedType(t.template)&&n.appendChild(t.template);if(n.childNodes.length>1)throw Error("UI.template should have only one parent node");t.dom=n.childNodes[0],t.plugins.apply(t.dom)},l=function(t,n,r){n&&(r?n.insertBefore(t.dom,r):n.appendChild(t.dom),p=n)},h=function(t,n){u(t),l.apply(null,s.toArray(arguments))},p=null,d=new t("Init",{Init:[["render",u,this,"Rendered"],["place",h,this,"Rendered"]],Rendered:[["place",l,this],["render",u,this]]});this.model=o instanceof n?o:new n,this.plugins=new r,this.template=null,this.dom=null,this.place=function(t,n){d.event("place",this,t,n)},this.render=function(){d.event("render",this)},this.setTemplateFromDom=function(t){return i.isAcceptedType(t)?(this.template=t,!0):!1},this.alive=function(t){return i.isAcceptedType(t)?(this.setTemplateFromDom(t),this.place(t.parentNode,t.nextElementSibling),!0):!1},this.getCurrentPlace=function(){return p}}}),define("Olives/Plugins",["Tools","Olives/DomUtils"],function(t,n){return function(){var r={},i=function(t){return t.trim()},s=function(t,n,s){n.split(";").forEach(function(e){var n=e.split(":"),u=n[0].trim(),a=n[1]?n[1].split(",").map(i):[];a.unshift(t),r[s]&&r[s][u]&&r[s][u].apply(r[s],a)})};this.add=function(t,n){var i=this,s="plugins";return typeof t=="string"&&typeof n=="object"&&n?(r[t]=n,n[s]={name:t,apply:function(){return i.apply.apply(i,arguments)}},!0):!1},this.addAll=function(n){return t.loop(n,function(e,t){this.add(t,e)},this)},this.get=function(t){return r[t]},this.del=function(t){return delete r[t]},this.apply=function(r){var i;return n.isAcceptedType(r)?(i=n.getNodes(r),t.loop(t.toArray(i),function(e){t.loop(n.getDataset(e),function(t,n){s(e,t,n)})}),r):!1}}}),define("Olives/Transport",["Observable","Tools"],function(t,n){return function(n,r){var i=null,s=null,o=new t,u={};this.setIO=function(t){return t&&typeof t.connect=="function"?(s=t,!0):!1},this.getIO=function(){return s},this.connect=function(t){return typeof t=="string"?(i=s.connect(t),!0):!1},this.getSocket=function(){return i},this.on=function(t,n){return i.on(t,n)},this.once=function(t,n){return i.once(t,n)},this.emit=function(t,n,r){return i.emit(t,n,r)},this.removeListener=function(t,n,r){return i.removeListener(t,n,r)},this.request=function(t,n,r,i){if(typeof t=="string"&&typeof n!="undefined"){var s={eventId:Date.now()+Math.floor(Math.random()*1e6),data:n},o=function(){r&&r.apply(i||null,arguments)};return this.once(s.eventId,o),this.emit(t,s),!0}return!1},this.listen=function(t,n,r,i){if(typeof t=="string"&&typeof n!="undefined"&&typeof r=="function"){var s={eventId:Date.now()+Math.floor(Math.random()*1e6),data:n,keepAlive:!0},o=function(){r&&r.apply(i||null,arguments)},u=this;return this.on(s.eventId,o),this.emit(t,s),function(){u.emit("disconnect-"+s.eventId),u.removeListener(s.eventId,o)}}return!1},this.setIO(n),this.connect(r)}}),define("Olives/UI-plugin",["Olives/OObject","Tools"],function(e,t){return function(r){var i={};this.place=function(n,r){if(!(i[r]instanceof e))throw new Error(r+" is not an OObject UI in place:"+r);i[r].place(n)},this.set=function(n,r){return typeof n=="string"&&r instanceof e?(i[n]=r,!0):!1},this.setAll=function(n){t.loop(n,function(e,t){this.set(t,e)},this)},this.get=function(t){return i[t]},this.setAll(r)}}),define("Olives/DomUtils",function(){return{getNodes:function(t,n){return this.isAcceptedType(t)?(t.parentNode||document.createDocumentFragment().appendChild(t),t.parentNode.querySelectorAll(n||"*")):!1},getDataset:function(t){var n=0,r,i={},s,o;if(this.isAcceptedType(t)){if(t.hasOwnProperty("dataset"))return t.dataset;for(r=t.attributes.length;n<r;n++)s=t.attributes[n].name.split("-"),s.shift()=="data"&&(i[o=s.join("-")]=t.getAttribute("data-"+o));return i}return!1},isAcceptedType:function(t){return t instanceof HTMLElement||t instanceof SVGElement?!0:!1},setAttribute:function(t,n,r){return t instanceof HTMLElement?(t[n]=r,!0):t instanceof SVGElement?(t.setAttribute(n,r),!0):!1}}}),define("Olives/Event-plugin",function(){return function(t){this.listen=function(e,n,r,i){e.addEventListener(n,function(n){t[r].call(t,n,e)},i=="true")}}}),define("Olives/LocalStore",["Store","Tools"],function(t,n){function r(){var e=null,t=localStorage,r=function(){t.setItem(e,this.toJSON())};this.setLocalStorage=function(n){return n&&n.setItem instanceof Function?(t=n,!0):!1},this.getLocalStorage=function(){return t},this.sync=function(s){var o;return typeof s=="string"?(e=s,o=JSON.parse(t.getItem(s)),n.loop(o,function(e,t){this.has(t)||this.set(t,e)},this),r.call(this),this.watch("added",r,this),this.watch("updated",r,this),this.watch("deleted",r,this),!0):!1}}return function(n){return r.prototype=new t(n),new r}}),define("Olives/Model-plugin",["Store","Observable","Tools","Olives/DomUtils"],function(t,n,r,s){return function(n,o){var u=null,f={},c={};this.observers={},this.setModel=function(n){return n instanceof t?(u=n,!0):!1},this.getModel=function(){return u},this.ItemRenderer=function(n,o){var f=null,c=null,h=null,p=null,m=null;this.setRenderer=function(t){return f=t,!0},this.getRenderer=function(){return f},this.setRootNode=function(t){var n;return s.isAcceptedType(t)?(h=t,n=h.querySelector("*"),this.setRenderer(n),n&&h.removeChild(n),!0):!1},this.getRootNode=function(){return h},this.setPlugins=function(t){return c=t,!0},this.getPlugins=function(){return c},this.items=new t([]),this.setStart=function(t){return p=parseInt(t,10),p},this.getStart=function(){return p},this.setNb=function(t){return m=t=="*"?t:parseInt(t,10),m},this.getNb=function(){return m},this.addItem=function(t){var n,r;return typeof t=="number"&&!this.items.get(t)?(n=this.create(t),n?(r=this.getNextItem(t),r?h.insertBefore(n,r):h.appendChild(n),!0):!1):!1},this.getNextItem=function(t){return this.items.alter("slice",t+1).filter(function(e){if(s.isAcceptedType(e))return!0})[0]},this.removeItem=function(t){var n=this.items.get(t);return n?(h.removeChild(n),this.items.set(t),!0):!1},this.create=function(t){if(u.has(t)){var n=f.cloneNode(!0),i=s.getNodes(n);return r.toArray(i).forEach(function(e){e.setAttribute("data-"+c.name+"_id",t)}),this.items.set(t,n),c.apply(n),n}},this.render=function(){var t=m=="*"?u.getNbItems():m,n=[];if(m!==null&&p!==null){this.items.loop(function(e,r){(r<p||r>=p+t||!u.has(r))&&n.push(r)},this),n.sort(r.compareNumbers).reverse().forEach(this.removeItem,this);for(i=p,l=t+p;i<l;i++)this.addItem(i);return!0}return!1},this.setPlugins(n),this.setRootNode(o)},this.setItemRenderer=function(t,n){t=t||"default",c[t]=n},this.getItemRenderer=function(t){return c[t]},this.foreach=function(t,n,r,i){var s=new this.ItemRenderer(this.plugins,t);s.setStart(r||0),s.setNb(i||"*"),s.render(),u.watch("added",s.render,s),u.watch("deleted",function(e){s.render(),this.observers[e]&&this.observers[e].forEach(function(e){u.unwatchValue(e)},this),delete this.observers[e]},this),this.setItemRenderer(n,s)},this.updateStart=function(t,n){var r=this.getItemRenderer(t);return r?(r.setStart(n),!0):!1},this.updateNb=function(t,n){var r=this.getItemRenderer(t);return r?(r.setNb(n),!0):!1},this.refresh=function(t){var n=this.getItemRenderer(t);return n?(n.render(),!0):!1},this.bind=function(t,n,i){i=i||"";var o=t.getAttribute("data-"+this.plugins.name+"_id"),f=i.split("."),l=o||f.shift(),c=o?i:f.join("."),h=r.getNestedProperty(u.get(l),c),p=r.toArray(arguments).slice(3);if(h||h===0||h===!1)this.execBinding.apply(this,[t,n,h].concat(p))||s.setAttribute(t,n,h);this.hasBinding(n)||t.addEventListener("change",function(e){u.has(l)&&(c?u.update(l,i,t[n]):u.set(l,t[n]))},!0),this.observers[l]=this.observers[l]||[],this.observers[l].push(u.watchValue(l,function(e){this.execBinding.apply(this,[t,n,r.getNestedProperty(e,c)].concat(p))||s.setAttribute(t,n,r.getNestedProperty(e,c))},this))},this.set=function(t){return s.isAcceptedType(t)&&t.name?(u.set(t.name,t.value),!0):!1},this.form=function(t){if(t&&t.nodeName=="FORM"){var n=this;return t.addEventListener("submit",function(e){r.toArray(t.querySelectorAll("[name]")).forEach(n.set,n),e.preventDefault()},!0),!0}return!1},this.addBinding=function(t,n){return t&&typeof t=="string"&&typeof n=="function"?(f[t]=n,!0):!1},this.execBinding=function(t,n){return this.hasBinding(n)?(f[n].apply(t,Array.prototype.slice.call(arguments,2)),!0):!1},this.hasBinding=function(t){return f.hasOwnProperty(t)},this.getBinding=function(t){return f[t]},this.addBindings=function(t){return r.loop(t,function(e,t){this.addBinding(t,e)},this)},this.setModel(n),this.addBindings(o)}}),define("Olives/OObject",["StateMachine","Store","Olives/Plugins","Olives/DomUtils","Tools"],function(t,n,r,i,s){return function(o){var u=function(t){var n=p||document.createElement("div");if(!t.template)throw Error("UI.template must be set prior to render");typeof t.template=="string"?n.innerHTML=t.template.trim():i.isAcceptedType(t.template)&&n.appendChild(t.template);if(n.childNodes.length>1)throw Error("UI.template should have only one parent node");t.dom=n.childNodes[0],t.plugins.apply(t.dom)},l=function(t,n,r){n&&(r?n.insertBefore(t.dom,r):n.appendChild(t.dom),p=n)},h=function(t,n){u(t),l.apply(null,s.toArray(arguments))},p=null,d=new t("Init",{Init:[["render",u,this,"Rendered"],["place",h,this,"Rendered"]],Rendered:[["place",l,this],["render",u,this]]});this.model=o instanceof n?o:new n,this.plugins=new r,this.template=null,this.dom=null,this.place=function(t,n){d.event("place",this,t,n)},this.render=function(){d.event("render",this)},this.setTemplateFromDom=function(t){return i.isAcceptedType(t)?(this.template=t,!0):!1},this.alive=function(t){return i.isAcceptedType(t)?(this.setTemplateFromDom(t),this.place(t.parentNode,t.nextElementSibling),!0):!1},this.getCurrentPlace=function(){return p}}}),define("Olives/Plugins",["Tools","Olives/DomUtils"],function(t,n){return function(){var r={},i=function(t){return t.trim()},s=function(t,n,s){n.split(";").forEach(function(e){var n=e.split(":"),u=n[0].trim(),a=n[1]?n[1].split(",").map(i):[];a.unshift(t),r[s]&&r[s][u]&&r[s][u].apply(r[s],a)})};this.add=function(t,n){var i=this,s="plugins";return typeof t=="string"&&typeof n=="object"&&n?(r[t]=n,n[s]={name:t,apply:function(){return i.apply.apply(i,arguments)}},!0):!1},this.addAll=function(n){return t.loop(n,function(e,t){this.add(t,e)},this)},this.get=function(t){return r[t]},this.del=function(t){return delete r[t]},this.apply=function(r){var i;return n.isAcceptedType(r)?(i=n.getNodes(r),t.loop(t.toArray(i),function(e){t.loop(n.getDataset(e),function(t,n){s(e,t,n)})}),r):!1}}}),define("Olives/Transport",["Observable","Tools"],function(t,n){return function(n,r){var i=null,s=null,o=new t,u={};this.setIO=function(t){return t&&typeof t.connect=="function"?(s=t,!0):!1},this.getIO=function(){return s},this.connect=function(t){return typeof t=="string"?(i=s.connect(t),!0):!1},this.getSocket=function(){return i},this.on=function(t,n){return i.on(t,n)},this.once=function(t,n){return i.once(t,n)},this.emit=function(t,n,r){return i.emit(t,n,r)},this.removeListener=function(t,n,r){return i.removeListener(t,n,r)},this.request=function(t,n,r,i){if(typeof t=="string"&&typeof n!="undefined"){var s={eventId:Date.now()+Math.floor(Math.random()*1e6),data:n},o=function(){r&&r.apply(i||null,arguments)};return this.once(s.eventId,o),this.emit(t,s),!0}return!1},this.listen=function(t,n,r,i){if(typeof t=="string"&&typeof n!="undefined"&&typeof r=="function"){var s={eventId:Date.now()+Math.floor(Math.random()*1e6),data:n,keepAlive:!0},o=function(){r&&r.apply(i||null,arguments)},u=this;return this.on(s.eventId,o),this.emit(t,s),function(){u.emit("disconnect-"+s.eventId),u.removeListener(s.eventId,o)}}return!1},this.setIO(n),this.connect(r)}}),define("Olives/UI-plugin",["Olives/OObject","Tools"],function(e,t){return function(r){var i={};this.place=function(n,r){if(!(i[r]instanceof e))throw new Error(r+" is not an OObject UI in place:"+r);i[r].place(n)},this.set=function(n,r){return typeof n=="string"&&r instanceof e?(i[n]=r,!0):!1},this.setAll=function(n){t.loop(n,function(e,t){this.set(t,e)},this)},this.get=function(t){return i[t]},this.setAll(r)}});