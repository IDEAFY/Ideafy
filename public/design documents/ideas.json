{
	"_id": "_design/ideas",
	"views": {
		"all": {
			"map": "function(doc){ if (doc.type == 6){ var nbVotes=0,rating=null,obj={};if(doc.votes&&doc.votes.length){nbVotes=doc.votes.length;rating=doc.votes.reduce(function(x,y){return  (x+y);})/nbVotes;}obj.nbVotes=nbVotes;obj.rating=rating;emit(doc._id,obj);}}"
		},
		"ideasbyauthor": {
			"map": "function(doc){if (doc.type == 6) {if (doc.authors && doc.authors.length) {doc.authors.forEach(function(author){emit(author, doc);});}}}"
		},
		"ideasbyvotes": {
			"map": "function(doc){if ((doc.type == 6) && doc.votes) {var arr = doc.votes.concat();var votes = arr.length;var rating = Math.round(arr.reduce(function(x,y){return x+y;})/votes*100)/100;emit([rating, votes], {'doc':doc, 'rating': rating, 'votes': votes});};}"
		}
	},
	"language": "javascript"
}